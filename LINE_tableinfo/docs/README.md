# LINE Database Viewer 開発者ドキュメント

## プロジェクト構造

```
LINE_tableinfo/
├── src/                    # ソースコード
│   ├── utils/             # ユーティリティ関数
│   │   ├── time_utils.py  # 時間変換関連
│   │   ├── database_utils.py  # DB操作関連
│   │   └── export_utils.py    # エクスポート関連
│   └── gui/               # GUI関連
│       └── gui_main.py    # メインGUIクラス
├── docs/                  # ドキュメント
├── tests/                 # テストコード
└── requirements.txt       # 依存パッケージ
```

## モジュール説明

### time_utils.py

時間変換に関する機能を提供します：

- `unix_micro_to_jst()`: UNIXマイクロ秒タイムスタンプをJST時間に変換
- `convert_timestamp()`: 各種タイムスタンプフォーマットの変換
  - JST
  - UNIX（マイクロ秒/秒）
  - MAC（HFS+）
  - WebKit
  - FILETIME
  - COCOA

### database_utils.py

データベース操作に関する機能を提供します：

- `connect_database()`: データベースへの接続
- `get_all_tables()`: テーブル一覧の取得
- `get_table_info()`: テーブル情報の取得
- `get_table_row_count()`: テーブルの行数取得
- `get_table_contents()`: テーブル内容の取得
- `check_deleted_messages()`: 削除メッセージの検索

### export_utils.py

データのエクスポート機能を提供します：

- `export_to_excel()`: テーブルデータのExcelエクスポート
  - 欠落したZ_PKの検出と追加
  - タイムスタンプの変換
  - 出力ファイルの自動命名

### gui_main.py

GUIの実装を提供します：

- `TimeFormatMenu`: 時間フォーマット選択メニュー
- `LineDBViewer`: メインGUIクラス
  - データベース接続管理
  - テーブル表示・操作
  - イベントハンドリング

## 開発ガイドライン

1. コーディング規約
   - PEP 8に準拠
   - 型ヒントを使用
   - docstringでの関数説明
   - 意味のある変数名の使用

2. エラーハンドリング
   - 適切な例外処理
   - ユーザーフレンドリーなエラーメッセージ
   - データベース接続の適切な管理

3. GUIデザイン
   - 直感的な操作性
   - レスポンシブな表示
   - 適切なフィードバック

4. パフォーマンス考慮事項
   - 大規模データベースへの対応
   - メモリ使用量の最適化
   - 非同期処理の活用

## 新機能の追加方法

1. 機能の設計
   - 目的と要件の明確化
   - 既存コードへの影響確認
   - インターフェースの設計

2. 実装手順
   - 適切なモジュールの選択/作成
   - テストコードの作成
   - ドキュメントの更新

3. プルリクエスト
   - コードレビュー
   - テスト実行
   - 変更内容の文書化

## 貢献方法

1. Issueの作成
   - バグ報告
   - 機能リクエスト
   - 改善提案

2. プルリクエスト
   - フォークしてブランチを作成
   - 変更を実装
   - テストを追加
   - プルリクエストを作成

## ライセンス

このプロジェクトはMITライセンスの下で公開されています。 